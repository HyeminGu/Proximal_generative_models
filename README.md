# Proximal generative models
Code submission for the paper **Learning heavy-tailed distributions with Wasserstein
proximal-regularized α-divergences** in Neurips 2024

## Instruction and directory structure
Compare different proximal generative models in ```scripts/[model_name]/```.

* ```f-Gamma-GAN```: Wasserstein-1 regularized alpha GAN vs alpha GAN; [(f,Γ)-Divergences: Interpolating between f-Divergences and Integral Probability Metrics](https://arxiv.org/abs/2011.05953)
* ```GPA_NN```: Wasserstein-1 regularized alpha GPA vs alpha GPA; [Lipschitz-regularized gradient flows and generative particle algorithms for high-dimensional scarce data](https://arxiv.org/abs/2210.17230)
* ```ot_flow-master```: OT flow vs CNF; [OT-Flow: Fast and Accurate Continuous Normalizing Flows via Optimal Transport](https://arxiv.org/abs/2006.00104)
* ```sgm_simple```: Score-based generative model (SGM) with Variance Exploding SDE; [Score-Based Generative Modeling through Stochastic Differential Equations
](https://arxiv.org/abs/2011.13456)

```GPA_NN```, ```OT_Flow_GAN```, ```ot_flow-master``` comes with ```runscript.sh``` file to run the experiments with different cases for the examples. 

```f-Gamma-GAN`` has two python codes for different examples. Simply running the code to produce experiment results with different cases for the examples.

```sgm_simple``` contains two jupyter notebooks for different examples. For ```SGM-VE-Learning_student_t``` set df=1.0 or df=3.0 and then run the entire blocks to produce results for the examples. 

Generated samples will be stored in ```assets/[example_name]/```. 

* ```Learning_student_t```: 2D Student-t experiments from ```GPA_NN``` and ```f-Gamma-GAN``` will be stored.
* ```student-t```: 2D Student-t experiments from other models will be stored.
* ```Keystrokes```: Keystrokes experiments will be stored.


After the sample generations, open and run jupyter notebook ```2D_Student_t.ipynb``` for the 2D Student-t example and ```Keystrokes.ipynb``` for the Keystrokes example to plot the results. 

The resulting plots are stored in ```figures``` directory.


## Access to the original dataset

* 2D student-t example: random samples are generated by python library ```scipy.stats.multivariate_t```.
* Keystrokes Example: Original data can be accessed from [Observations on Typing from 136 Million Keystrokes](https://dl.acm.org/doi/10.1145/3173574.3174220).
We preprocess the data by combining data from id=[27252, 36718, 56281, 64663, 67159, 97737, 145007, 159915, 264420, 271802] and then extract inter-arrival time between keystrokes.
Resulting dataset consists of 7160 samples and the data is stored at ```pn4874/inter_stroke_time.txt```.

 
